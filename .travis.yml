sudo: required
language: python
python: "3.6"

env:
    - MONGODB_VER=mongodb-linux-x86_64-2.6.12 WIRED_TIGER=false
    - MONGODB_VER=mongodb-linux-x86_64-3.4.16 WIRED_TIGER=false
    - MONGODB_VER=mongodb-linux-x86_64-3.4.16 WIRED_TIGER=true
    - MONGODB_VER=mongodb-linux-x86_64-3.6.6  WIRED_TIGER=false
    - MONGODB_VER=mongodb-linux-x86_64-3.6.6  WIRED_TIGER=true
    
install:
  - pip install -r requirements.txt
  
  - wget http://fastdl.mongodb.org/linux/$MONGODB_VER.tgz
  - tar xfz $MONGODB_VER.tgz
  - export MONGOD=`pwd`/$MONGODB_VER/bin/mongod
  - cd -
  - cp -n test.cfg.example test.cfg
  - sed -i "s#^test.temp.dir=.*#test.temp.dir=temp_test_dir#" test.cfg
  - sed -i "s#^test.mongo.exe.*#test.mongo.exe=$MONGOD#" test.cfg
  - sed -i "s#^test.mongo.wired_tiger.*#test.mongo.wired_tiger=$WIRED_TIGER#" test.cfg
  - cat test.cfg
 
script:
  - make test

after_success:
  - coveralls